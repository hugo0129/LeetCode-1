[toc]

```java
class Solution {
    public int[] assignBikes(int[][] workers, int[][] bikes) {
        if(workers == null || workers.length == 0) {
            return new int[]{};
        }
        if(bikes == null || workers.length > bikes.length) {
            throw new IllegalArgumentException("invalid param");
        }
        // 是否已分配标识
        boolean[] workFlag = new boolean[workers.length];
        boolean[] bikeFlag = new boolean[bikes.length];
        // 距离数组
        Integer[][] distance = new Integer[workers.length * bikes.length][3];
        for (int i = 0; i < workers.length; i++) {
            for (int j = 0; j < bikes.length; j++) {
                int dis = Math.abs(workers[i][0] - bikes[j][0])
                        + Math.abs(workers[i][1] - bikes[j][1]);
                distance[i * bikes.length + j] = new Integer[]{i, j, dis};
            }
        }
        // 排序
        Arrays.sort(distance, (a, b) -> {
            // 距离相等
            if(a[2] == b[2]) {
                // 个人序号小的或自行车序号小的在前面
                return a[0] == b[0] ? a[1] - b[1] : a[0] - b[0];
            } else {
                return a[2] - b[2];
            }
        });
        // 遍历
        int[] res = new int[workers.length];
        for(int i = 0; i < distance.length; i++) {
            Integer[] cur = distance[i];
            // 已被分配
            if(workFlag[cur[0]] || bikeFlag[cur[1]]) {
                continue;
            }
            workFlag[cur[0]] = true;
            bikeFlag[cur[1]] = true;
            res[cur[0]] = cur[1];
        }
        return res;
    }
}
```
