[toc]

```java
class Solution {
    public int[] rearrangeBarcodes(int[] barcodes) {
        if(barcodes == null || barcodes.length == 0) {
            throw new IllegalArgumentException("invalid param");
        }
        // 计数
        Map<Integer, Integer> counter = new HashMap<>();
        for (int num : barcodes) counter.put(num, counter.getOrDefault(num, 0) + 1);
        // 最大堆排序
        PriorityQueue<int[]> queue = new PriorityQueue<>((a, b) -> b[1] - a[1]);
        for (Map.Entry<Integer, Integer> entry : counter.entrySet()) {
            queue.add(new int[]{entry.getKey(), entry.getValue()});
        }
        int[] res = new int[barcodes.length];
        int idx = 0;
        while (!queue.isEmpty()) {
            int[] cur = queue.poll();
            if(cur[1] > (1 + barcodes.length) / 2) throw new IllegalArgumentException("error param");
            for (int i = cur[1]; i > 0; i--) {
                if(idx >= barcodes.length) {
                    idx = 1;
                }
                res[idx] = cur[0];
                idx += 2;
            }
        }
        return res;
    }
}
```
