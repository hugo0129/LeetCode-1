[toc]



```java
class Solution {
    public TreeNode constructFromPrePost(int[] pre, int[] post) {
        if(pre == null || pre.length == 0) {
            return null;
        }
        return constructFromPrePost(pre, 0, pre.length - 1, post, 0 , post.length - 1);
    }

    private TreeNode constructFromPrePost(int[] pre, int s1, int e1, int[] post, int s2, int e2) {
        // 根节点值不一样，抛异常
        if(pre[s1] != post[e2]) {
            throw new IllegalArgumentException("invalid param");
        }
        TreeNode root = new TreeNode(pre[s1]);

        // 叶节点，返回
        if(s1 == e1) {
            return root;
        }
        int l = --e2, r = ++s1;
        // 只有一个子节点，此时不能唯一确定，题目要求返回任意一个，此处设定为左子树
        if(pre[s1] == post[e2]) {
            root.left = constructFromPrePost(pre, s1, e1, post, s2, e2);
            return root;
        }
        // 在后序序列中查找左子树根节点
        for(; l >= s2; l--) {
            if(post[l] == pre[s1]) break;
        }
        // 在前序序列中查找右子树根节点
        for(; r <= e1; r++) {
            if(pre[r] == post[e2]) break;
        }

        root.left = constructFromPrePost(pre, s1, r - 1, post, s2, l);
        root.right = constructFromPrePost(pre, r, e1, post, l + 1, e2);
        return root;
    }
}
```

